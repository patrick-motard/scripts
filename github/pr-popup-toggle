#!/bin/bash

# Toggle pr-select popup in tmux
# If popup is open, close it. If closed, open it.

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Check if we're in tmux
if [[ -z "$TMUX" ]]; then
    # Not in tmux, just run pr-select directly
    exec "$SCRIPT_DIR/pr-select" "$@"
fi

# Try to close any existing popup first
# If successful, a popup was open and we've closed it, so exit
if tmux display-popup -C 2>/dev/null; then
    exit 0
fi

# No popup was open, so launch it
POPUP_WIDTH="80%"
POPUP_HEIGHT="80%"

tmux display-popup -E -w "$POPUP_WIDTH" -h "$POPUP_HEIGHT" \
    "$SCRIPT_DIR/pr-select $*"
